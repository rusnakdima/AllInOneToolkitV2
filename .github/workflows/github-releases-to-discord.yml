name: GitHub Releases to Discord Forum
on:
  release:
    types: [published]

jobs:
  github-releases-to-discord-forum:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create Discord Forum Post
        run: |
          # Create JSON payload safely
          cat > payload.json << 'EOF'
          {
            "thread_name": "ðŸš€ All In One Toolkit V2 - Release ${{ github.event.release.tag_name }}",
            "content": "**Attention! New program update released!** ðŸ“¢\n\nðŸ”— **Download:** [${{ github.event.release.tag_name }}](${{ github.event.release.html_url }})\n\nðŸ“ **Release Notes:**\n```\n${{ github.event.release.body }}\n```\n\n---\n\n**Russian translation** ðŸ‡·ðŸ‡º\n**Ð’Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ! Ð’Ñ‹ÑˆÐ»Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹!** ðŸ“¢\n\nðŸ”— **Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ:** [${{ github.event.release.tag_name }}](${{ github.event.release.html_url }})\n\nðŸ“ **ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ Ðº Ð²Ñ‹Ð¿ÑƒÑÐºÑƒ:**\n```\n${{ github.event.release.body }}\n```",
            "username": "Release Bot",
            "avatar_url": "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
          }
          EOF

          # Send the request
          curl -X POST "${{ secrets.WEBHOOK_URL }}" \
            -H "Content-Type: application/json" \
            --data @payload.json \
            --fail \
            --show-error

      # Alternative approach using discord-action (if it supports forums)
      - name: Alternative - Using Discord Action
        if: failure()
        uses: appleboy/discord-action@v1.0.0
        with:
          webhook: ${{ secrets.WEBHOOK_URL }}
          thread_name: "ðŸš€ All In One Toolkit V2 - Release ${{ github.event.release.tag_name }}"
          message: |
            **ðŸš€ New Release Available!** 

            ðŸ“¦ **Version:** ${{ github.event.release.tag_name }}
            ðŸ”— **Download:** ${{ github.event.release.html_url }}

            ðŸ“ **Release Notes:**
            ${{ github.event.release.body }}

            ---

            **ðŸ‡·ðŸ‡º Ð ÑƒÑÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÐ²Ð¾Ð´**
            **ðŸš€ ÐÐ¾Ð²Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°!**

            ðŸ“¦ **Ð’ÐµÑ€ÑÐ¸Ñ:** ${{ github.event.release.tag_name }}
            ðŸ”— **Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ:** ${{ github.event.release.html_url }}

            ðŸ“ **ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ Ðº Ð²Ñ‹Ð¿ÑƒÑÐºÑƒ:**
            ${{ github.event.release.body }}
