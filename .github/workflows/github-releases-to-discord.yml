name: GitHub Releases to Discord Forum
on:
  release:
    types: [published]

jobs:
  github-releases-to-discord-forum:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create Discord Forum Post
        run: |
          curl -X POST "${{ secrets.WEBHOOK_URL }}" \
            -H "Content-Type: application/json" \
            -d '{
              "thread_name": "ğŸš€ All In One Toolkit V2 - Release ${{ github.event.release.tag_name }}",
              "content": "**Attention! New program update released!** ğŸ“¢\n\nğŸ”— **Download:** [${{ github.event.release.tag_name }}](${{ github.event.release.html_url }})\n\nğŸ“ **Release Notes:**\n${{ github.event.release.body }}\n\n---\n\n**Russian translation** ğŸ‡·ğŸ‡º\n**Ğ’Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ! Ğ’Ñ‹ÑˆĞ»Ğ¾ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹!** ğŸ“¢\n\nğŸ”— **Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ:** [${{ github.event.release.tag_name }}](${{ github.event.release.html_url }})\n\nğŸ“ **ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ Ğº Ğ²Ñ‹Ğ¿ÑƒÑĞºÑƒ:**\n${{ github.event.release.body }}",
              "username": "Release Bot",
              "avatar_url": "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
            }'

      - name: Alternative - Create Forum Post with Embeds
        if: failure()
        run: |
          curl -X POST "${{ secrets.WEBHOOK_URL }}" \
            -H "Content-Type: application/json" \
            -d '{
              "thread_name": "ğŸš€ All In One Toolkit V2 - Release ${{ github.event.release.tag_name }}",
              "embeds": [
                {
                  "title": "ğŸš€ New Release: ${{ github.event.release.tag_name }}",
                  "description": "All In One Toolkit V2 has been updated!",
                  "url": "${{ github.event.release.html_url }}",
                  "color": 5814783,
                  "fields": [
                    {
                      "name": "ğŸ“¥ Download",
                      "value": "[Release Page](${{ github.event.release.html_url }})",
                      "inline": true
                    },
                    {
                      "name": "ğŸ·ï¸ Version",
                      "value": "${{ github.event.release.tag_name }}",
                      "inline": true
                    },
                    {
                      "name": "ğŸ“ Release Notes",
                      "value": "${{ github.event.release.body || 'No release notes provided.' }}",
                      "inline": false
                    }
                  ],
                  "timestamp": "${{ github.event.release.published_at }}",
                  "footer": {
                    "text": "GitHub Release",
                    "icon_url": "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
                  }
                }
              ],
              "username": "Release Bot",
              "avatar_url": "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
            }'
